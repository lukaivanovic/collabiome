{% comment %}
  Renders cart drawer with clean modern design

  Usage:
  {% render 'cart-drawer' %}
{% endcomment %}

<script src="{{ 'cart.js' | asset_url }}" defer="defer"></script>

<style>
  .drawer {
    visibility: hidden;
  }
</style>

<cart-drawer class="drawer{% if cart == empty %} is-empty{% endif %}">
  <div id="CartDrawer" class="cart-drawer">
    <div id="CartDrawer-Overlay" class="cart-drawer__overlay"></div>
    <div
      class="drawer__inner"
      role="dialog"
      aria-modal="true"
      aria-label="{{ 'sections.cart.title' | t }}"
      tabindex="-1"
    >
      {%- if cart == empty -%}
        <div class="drawer__inner-empty">
          <div class="cart-drawer__warnings center">
            <div class="cart-drawer__empty-content">
              <h2 class="cart__empty-text">{{ 'sections.cart.empty' | t }}</h2>
              <button
                class="drawer__close"
                type="button"
                onclick="this.closest('cart-drawer').close()"
                aria-label="{{ 'accessibility.close' | t }}"
              >
                <span class="svg-wrapper">
                  {{- 'icon-close.svg' | inline_asset_content -}}
                </span>
              </button>
              <a href="{{ routes.all_products_collection_url }}" class="button">
                {{ 'general.continue_shopping' | t }}
              </a>
            </div>
          </div>
        </div>
      {%- endif -%}

      <!-- Header -->
      <div class="drawer__header">
        <a href="#" class="drawer__back-link" onclick="this.closest('cart-drawer').close()">
          <span class="svg-wrapper">
            {{- 'icon-chevron-left.svg' | inline_asset_content -}}
          </span>
          {{ 'general.continue_shopping' | t }}
        </a>

        <div class="drawer__title-section">
          <h2 class="drawer__main-title">{{ 'sections.cart.title' | t }}</h2>
          <p class="drawer__subtitle">{{ 'sections.cart.cart_items' | t }}</p>
        </div>

        <button
          class="drawer__close"
          type="button"
          onclick="this.closest('cart-drawer').close()"
          aria-label="{{ 'accessibility.close' | t }}"
        >
          <span class="svg-wrapper">
            {{- 'icon-close.svg' | inline_asset_content -}}
          </span>
        </button>
      </div>

      <!-- Cart Items -->
      <cart-drawer-items
        {% if cart == empty %}
          class="is-empty"
        {% endif %}
      >
        <form
          action="{{ routes.cart_url }}"
          id="CartDrawer-Form"
          class="cart__contents cart-drawer__form"
          method="post"
        >
          <div id="CartDrawer-CartItems" class="drawer__contents js-contents">
            {%- if cart != empty -%}
              <div class="drawer__cart-items-wrapper">
                {%- for item in cart.items -%}
                  <div class="cart-item-card">
                    <!-- Product Image -->
                    <div class="cart-item__image-wrapper">
                      {% if item.image %}
                        <img
                          class="cart-item__image"
                          src="{{ item.image | image_url: width: 300 }}"
                          alt="{{ item.image.alt | escape }}"
                          loading="lazy"
                          width="80"
                          height="80"
                        >
                      {% endif %}
                    </div>

                    <!-- Product Details -->
                    <div class="cart-item__details">
                      <div class="cart-item__info">
                        {%- if settings.show_vendor -%}
                          <p class="cart-item__category">{{ item.product.vendor }}</p>
                        {%- endif -%}

                        <h3 class="cart-item__name">{{ item.product.title | escape }}</h3>

                        <div class="cart-item__price-wrapper">
                          {%- if item.original_price != item.final_price -%}
                            <span class="cart-item__old-price">{{ item.original_price | money }}</span>
                          {%- endif -%}
                          <span class="cart-item__price">{{ item.final_price | money }}</span>
                        </div>
                      </div>

                      <!-- Quantity Selector -->
                      <div class="cart-item__quantity-section">
                        <div class="quantity-selector">
                          <button
                            class="quantity__button"
                            name="minus"
                            type="button"
                            data-variant-id="{{ item.variant.id }}"
                            data-quantity="{{ item.quantity | minus: 1 }}"
                          >
                            <span class="svg-wrapper">
                              {{- 'icon-minus.svg' | inline_asset_content -}}
                            </span>
                          </button>
                          <input
                            class="quantity__input"
                            type="number"
                            value="{{ item.quantity }}"
                            min="0"
                            data-variant-id="{{ item.variant.id }}"
                            readonly
                          >
                          <button
                            class="quantity__button"
                            name="plus"
                            type="button"
                            data-variant-id="{{ item.variant.id }}"
                            data-quantity="{{ item.quantity | plus: 1 }}"
                          >
                            <span class="svg-wrapper">
                              {{- 'icon-plus.svg' | inline_asset_content -}}
                            </span>
                          </button>
                        </div>

                        <!-- Remove Button -->
                        <button
                          class="cart-remove-button"
                          type="button"
                          data-variant-id="{{ item.variant.id }}"
                          aria-label="{{ 'sections.cart.remove_title' | t: title: item.title | escape }}"
                        >
                          <span class="svg-wrapper">
                            {{- 'icon-remove.svg' | inline_asset_content -}}
                          </span>
                          {{ 'sections.cart.remove' | t }}
                        </button>
                      </div>
                    </div>
                  </div>
                {%- endfor -%}
              </div>
            {%- endif -%}
          </div>
        </form>
      </cart-drawer-items>

      <!-- Footer -->
      <div class="drawer__footer">
        {%- if cart != empty -%}
          <div class="order-summary">
            <h3 class="order-summary__title">{{ 'sections.cart.order_summary' | t }}</h3>

            <!-- Subtotal -->
            <div class="order-summary__line">
              <span class="order-summary__label">{{ 'sections.cart.subtotal' | t }}</span>
              <span class="order-summary__value">{{ cart.total_price | money }}</span>
            </div>

            <!-- Coupon Code -->
            <div class="order-summary__line">
              <span class="order-summary__label">{{ 'sections.cart.coupon_code' | t }}</span>
              <a href="#" class="order-summary__coupon-link">{{ 'sections.cart.add_code' | t }}</a>
            </div>

            <!-- Delivery -->
            <div class="order-summary__line">
              <span class="order-summary__label">{{ 'sections.cart.delivery' | t }}</span>
              <span class="order-summary__value">{{ 'sections.cart.delivery_calculated' | t }}</span>
            </div>

            <!-- Total -->
            <div class="order-summary__line order-summary__line--total">
              <span class="order-summary__label">{{ 'sections.cart.total' | t }}</span>
              <span class="order-summary__value">{{ cart.total_price | money }}</span>
            </div>
          </div>

          <!-- Checkout Button -->
          <div class="cart__ctas">
            <button
              type="submit"
              id="CartDrawer-Checkout"
              class="cart__checkout-button"
              name="checkout"
              form="CartDrawer-Form"
            >
              {{ 'sections.cart.checkout' | t }}
            </button>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</cart-drawer>

{% doc %}
  Header Mega Menu

  Renders collection-based mega menu panels for the desktop header.

  @param {linklist} shop_menu - Main navigation with collection links (required)
  @param {linklist} cosmetics_menu - Secondary menu for cosmetics collections
  @param {linklist} supplements_menu - Secondary menu for supplements collections
{% enddoc %}

{% liquid
  assign shop_menu = shop_menu | default: empty
  assign cosmetics_menu = cosmetics_menu | default: empty
  assign supplements_menu = supplements_menu | default: empty

  unless shop_menu != empty and shop_menu.links.size > 0
    break
  endunless
%}

<div data-mega-menu-panels>
  {% for link in shop_menu.links %}
    {% if link.type == 'collection_link' %}
      {% liquid
        assign submenu = blank

        if link.object.handle == 'kozmetika' or link.object.handle == 'cosmetics'
          if cosmetics_menu and cosmetics_menu.links.size > 0
            assign submenu = cosmetics_menu
          endif
        elsif link.object.handle == 'dodaci-prehrani' or link.object.handle == 'supplements'
          if supplements_menu and supplements_menu.links.size > 0
            assign submenu = supplements_menu
          endif
        endif
      %}

      {% liquid
        assign panel_snippet = 'header-mega-menu-cosmetics'

        if link.object.handle == 'dodaci-prehrani' or link.object.handle == 'supplements'
          assign panel_snippet = 'header-mega-menu-supplements'
        endif
      %}

      {% render panel_snippet, link: link, submenu: submenu %}
    {% endif %}
  {% endfor %}
</div>

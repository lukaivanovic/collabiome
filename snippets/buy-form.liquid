<product-form
  class="product-form"
  data-hide-errors="{{ gift_card_recipient_feature_active }}"
  data-section-id="{{ section.id }}"
>
  <div class="product-form__error-message-wrapper" role="alert" hidden>
    <span class="svg-wrapper">
      {{- 'icon-error.svg' | inline_asset_content -}}
    </span>
    <span class="product-form__error-message"></span>
  </div>

  {%- form 'product',
    product,
    id: product_form_id,
    class: 'form',
    novalidate: 'novalidate',
    data-type: 'add-to-cart-form'
  -%}
    <input
      type="hidden"
      name="id"
      value="{{ product.selected_or_first_available_variant.id }}"
      {% if product.selected_or_first_available_variant.available == false
        or quantity_rule_soldout
        or product.selected_or_first_available_variant == null
      %}
        disabled
      {% endif %}
      class="product-variant-id"
    >
    <div class="flex flex-col gap-4">
      {% unless product.has_only_default_variant %}
        <div class="flex flex-col gap-1">
          {% comment %}  Variants {% endcomment %}
          {% for option in product.options_with_values %}
            {% comment %}  Options {% endcomment %}
            <div class="flex flex-col border border-gray-200 rounded-lg">
              {% for value in option.values %}
                <label class="flex items-center justify-between px-4 py-4 gap-3 cursor-pointer{% unless forloop.last %} border-b border-gray-200{% endunless %}">
                  <div class="flex items-center gap-2">
                    <input
                      type="radio"
                      name="options[{{ option.name }}]"
                      value="{{ value }}"
                      {% if option.selected_value == value %}
                        checked
                      {% endif %}
                      class="w-4 h-4 rounded-full border border-gray-300 cursor-pointer"
                    >
                    <span class="text-large  text-primary">{{ value }}</span>
                  </div>
                  <div class="flex items-center gap-3 self-end">
                    <span class="text-base text-accent line-through">
                      {{- value.variant.compare_at_price | money -}}
                    </span>
                    <span class="text-large">{{ value.variant.price | money }}</span>
                  </div>
                </label>
              {% endfor %}
            </div>
          {% endfor %}
        </div>
      {% endunless %}

      {% comment %}  Quantity selector {% endcomment %}

      {% comment %}
        <div class="flex items-center justify-between w-40 border border-gray-200 rounded-lg overflow-hidden px-2">
          <button
            type="button"
            class="flex items-center justify-center w-5 h-5 bg-gray-100 text-gray-700 hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed rounded-full"
            aria-label="Decrease quantity"
            data-quantity-minus
          >
            {{ 'icon-minus.svg' | inline_asset_content }}
          </button>
          <input
            type="number"
            id="quantity-{{ section_id | default: 'main' }}"
            name="quantity"
            value="1"
            min="1"
            class="quantity-input w-16 h-11 text-center text-base outline-none [appearance:none]"
            aria-label="Quantity"
          >
          <button
            type="button"
            class="flex items-center justify-center w-5 h-5 bg-gray-100 text-gray-700 hover:bg-gray-200 disabled:opacity-30 disabled:cursor-not-allowed rounded-full"
            aria-label="Increase quantity"
            data-quantity-plus
          >
            {{ 'icon-plus.svg' | inline_asset_content }}
          </button>
        </div>
      {% endcomment %}

      {% comment %}  Submit button {% endcomment %}

      <div class="product-form__buttons">
        {%- liquid
          assign check_against_inventory = true
          if product.selected_or_first_available_variant.inventory_management != 'shopify' or product.selected_or_first_available_variant.inventory_policy == 'continue'
            assign check_against_inventory = false
          endif
          if product.selected_or_first_available_variant.quantity_rule.min > product.selected_or_first_available_variant.inventory_quantity and check_against_inventory
            assign quantity_rule_soldout = true
          endif
        -%}
        <button
          id="ProductSubmitButton-{{ section_id | default: 'main' }}"
          type="submit"
          name="add"
          class="product-form__submit button button--full-width button-recupera text-blue w-full"
          {% if product.selected_or_first_available_variant.available == false
            or quantity_rule_soldout
            or product.selected_or_first_available_variant == null
          %}
            disabled
          {% endif %}
        >
          <span>
            {%- if product.selected_or_first_available_variant == null -%}
              Unavailable
            {%- elsif product.selected_or_first_available_variant.available == false or quantity_rule_soldout -%}
              {{ 'products.product.sold_out' | t }}
            {%- else -%}
              {{ 'products.product.add_to_cart' | t }}
            {%- endif -%}
          </span>
          {% comment %} {%- render 'loading-spinner' -%} {% endcomment %}
        </button>
        {%- if show_dynamic_checkout -%}
          {{ form | payment_button }}
        {%- endif -%}
      </div>
    </div>
  {%- endform -%}
</product-form>
